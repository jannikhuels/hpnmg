<?xml version="1.0" encoding="UTF-8"?>
<HPnG>
  <places>
    <continuousPlace id="ev" capacity="%max_soc%" infiniteCapacity="0" level="0"/>

    <discretePlace marking="1" id="in lot"/>

    <discretePlace marking="%m_pps%" id="policy power supply"/>
    <discretePlace marking="1" id="regular price"/>
    <discretePlace marking="0" id="low price"/>

    <discretePlace marking="%m_ppd%" id="policy power demand"/>
    <discretePlace marking="1" id="stable grid"/>
    <discretePlace marking="0" id="unstable grid"/>
  </places>
  <transitions>
    <generalTransition id="client return" cdf="foldednormal" priority="0" weight="1" policy="resume">
      <parameter name="mu" value="%mu_return%"/>
      <parameter name="sigma" value="%sigma_return%"/>
    </generalTransition>
<!--    <generalTransition id="client return" cdf="uniform" priority="0" weight="1" policy="resume">-->
<!--      <parameter name="a" value="0"/>-->
<!--      <parameter name="b" value="%mu_return%"/>-->
<!--    </generalTransition>-->

    <continuousTransition id="base charge" rate="%r_base%"/>

    <continuousTransition id="extra charge" rate="%r_g2v%"/>
    <deterministicTransition id="price recovery" priority="0" weight="1" discTime="%t_pr%" />
<!--    <generalTransition id="price slump" cdf="normal" priority="0" weight="1" policy="resume">&lt;!&ndash; TODO: proper distribution &ndash;&gt;-->
<!--      <parameter name="mu" value="%mu_return%"/>-->
<!--      <parameter name="sigma" value="%sigma_return%"/>-->
<!--    </generalTransition>-->
    <generalTransition id="price slump" cdf="uniform" priority="0" weight="1" policy="resume"><!-- TODO: proper distribution -->
        <parameter name="a" value="0"/>
        <parameter name="b" value="%mu_return%"/>
    </generalTransition>

    <continuousTransition id="charge penalty" rate="%r_v2g%"/>
    <deterministicTransition id="demand increase" priority="0" weight="1" discTime="%t_di%" />
<!--    <generalTransition id="demand decrease" cdf="normal" priority="0" weight="1" policy="resume">&lt;!&ndash; TODO: proper distribution &ndash;&gt;-->
<!--      <parameter name="mu" value="%mu_return%"/>-->
<!--      <parameter name="sigma" value="%sigma_return%"/>-->
<!--    </generalTransition>-->
    <generalTransition id="demand decrease" cdf="uniform" priority="0" weight="1" policy="resume"><!-- TODO: proper distribution -->
        <parameter name="a" value="0"/>
        <parameter name="b" value="%mu_return%"/>
    </generalTransition>
  </transitions>
  <arcs>
    <discreteArc weight="1" fromNode="in lot" toNode="client return" id="in lot to client return"/>

    <guardArc weight="1" isInhibitor="0" fromNode="in lot" toNode="base charge" id="in lot to base charge"/>
    <continuousArc share="1" priority="0" weight="1" fromNode="base charge" toNode="ev" id="base charge to ev"/>

    <guardArc weight="1" isInhibitor="0" fromNode="in lot" toNode="extra charge" id="in lot to extra charge"/>
    <guardArc weight="1" isInhibitor="0" fromNode="low price" toNode="extra charge" id="low price to extra charge"/>
    <continuousArc share="1" priority="0" weight="1" fromNode="extra charge" toNode="ev" id="extra charge to ev"/>
    <discreteArc weight="1" fromNode="policy power supply" toNode="price slump" id="policy power supply to price slump"/>
    <discreteArc weight="1" fromNode="regular price" toNode="price slump" id="regular price to price slump"/>
    <discreteArc weight="1" fromNode="price slump" toNode="low price" id="price slump to low price"/>
    <discreteArc weight="1" fromNode="low price" toNode="price recovery" id="low price to price recovery"/>
    <discreteArc weight="1" fromNode="price recovery" toNode="regular price" id="price recovery to regular price"/>


    <guardArc weight="1" isInhibitor="0" fromNode="in lot" toNode="charge penalty" id="in lot to charge penalty"/>
    <guardArc weight="1" isInhibitor="0" fromNode="unstable grid" toNode="charge penalty" id="unstable grid to charge penalty"/>
    <continuousArc share="1" priority="0" weight="1" fromNode="ev" toNode="charge penalty" id="ev to charge penalty"/>
    <discreteArc weight="1" fromNode="policy power demand" toNode="demand increase" id="policy power demand to demand increase"/>
    <discreteArc weight="1" fromNode="stable grid" toNode="demand increase" id="stable grid to demand increase"/>
    <discreteArc weight="1" fromNode="demand increase" toNode="unstable grid" id="demand increase to unstable grid"/>
    <discreteArc weight="1" fromNode="unstable grid" toNode="demand decrease" id="unstable grid to demand decrease"/>
    <discreteArc weight="1" fromNode="demand decrease" toNode="stable grid" id="demand decrease to stable grid"/>
  </arcs>
</HPnG>
